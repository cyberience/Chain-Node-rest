{"version":3,"sources":["../../src/utils/objects.js"],"names":["isObject","object","Array","isArray","areCompatible","lhs","rhs","objects","deepAssign","target","sources","forEach","Object","keys","source","key","checkSchemaAgainstTemplate","template","undefined","Error","module","exports"],"mappings":";;;;AAAA;;;;;;;;;;;;;;;;;;;;AAoBA;AACA,IAAMA,WAAW,SAAXA,QAAW;AAAA,QAAU,qBAAoBC,MAApB,yCAAoBA,MAApB,MAA8B,CAACC,MAAMC,OAAN,CAAcF,MAAd,CAA/B,IAAwD,SAASA,MAA3E;AAAA,CAAjB;;AAEA,IAAMG,gBAAgB,SAAhBA,aAAgB,CAACC,GAAD,EAAMC,GAAN;AAAA,QACrB,QAAOD,GAAP,yCAAOA,GAAP,eAAsBC,GAAtB,yCAAsBA,GAAtB,MAA+B,SAASD,GAAV,MAAoB,SAASC,GAA7B,CAA9B,IAAqEJ,MAAMC,OAAN,CAAcE,GAAd,MAAuBH,MAAMC,OAAN,CAAcG,GAAd,CADvE;AAAA,CAAtB;;AAGA;AACA,IAAMC,UAAU;AACf;;;;;;AAMAC,aAAY,oBAACC,MAAD,EAAwB;AAAA,oCAAZC,OAAY;AAAZA,UAAY;AAAA;;AACnCA,UAAQC,OAAR,CAAgB;AAAA,UAAUC,OAAOC,IAAP,CAAYC,MAAZ,EAAoBH,OAApB,CAA4B,eAAO;AAC5D,QAAIX,SAASS,OAAOM,GAAP,CAAT,KAAyBf,SAASc,OAAOC,GAAP,CAAT,CAA7B,EACCR,QAAQC,UAAR,CAAmBC,OAAOM,GAAP,CAAnB,EAAgCD,OAAOC,GAAP,CAAhC,EADD,KAGCN,OAAOM,GAAP,IAAcD,OAAOC,GAAP,CAAd;AACD,IALyB,CAAV;AAAA,GAAhB;;AAOA,SAAON,MAAP;AACA,EAhBc;;AAkBf;;;;;;AAMAO,6BAA4B,oCAACC,QAAD,EAAWhB,MAAX,EAAsB;AACjD;AACAW,SAAOC,IAAP,CAAYZ,MAAZ,EAAoBU,OAApB,CAA4B,eAAO;AAClC,OAAIX,SAASiB,SAASF,GAAT,CAAT,KAA2Bf,SAASC,OAAOc,GAAP,CAAT,CAA/B,EAAsD;AACrDR,YAAQS,0BAAR,CAAmCC,SAASF,GAAT,CAAnC,EAAkDd,OAAOc,GAAP,CAAlD;AACA,IAFD,MAEO;AACN,QAAIG,cAAcD,SAASF,GAAT,CAAlB,EACC,MAAM,IAAII,KAAJ,gBAAsBJ,GAAtB,sBAAN;;AAED,QAAI,CAACX,cAAca,SAASF,GAAT,CAAd,EAA6Bd,OAAOc,GAAP,CAA7B,CAAL,EACC,MAAM,IAAII,KAAJ,iBAAuBJ,GAAvB,gCAAN;AACD;AACD,GAVD;AAWA;AArCc,CAAhB;;AAwCAK,OAAOC,OAAP,GAAiBd,OAAjB","file":"objects.js","sourcesContent":["/*\n * Copyright (c) 2016-present,\n * Jaguar0625, gimre, BloodyRookie, Tech Bureau, Corp. All rights reserved.\n *\n * This file is part of Catapult.\n *\n * Catapult is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Catapult is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with Catapult.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n// differentiate between object, array and null even though they all report the same type ('object')\nconst isObject = object => 'object' === typeof object && !Array.isArray(object) && null !== object;\n\nconst areCompatible = (lhs, rhs) =>\n\ttypeof lhs === typeof rhs && ((null === lhs) === (null === rhs)) && (Array.isArray(lhs) === Array.isArray(rhs));\n\n/** @exports utils/objects */\nconst objects = {\n\t/**\n\t * Deeply assigns properties in target from one or more source objects.\n\t * @param {object} target The target object.\n\t * @param {...object} sources The source objects with latter objects having precedence.\n\t * @returns {object} The target object (for chaining).\n\t */\n\tdeepAssign: (target, ...sources) => {\n\t\tsources.forEach(source => Object.keys(source).forEach(key => {\n\t\t\tif (isObject(target[key]) && isObject(source[key]))\n\t\t\t\tobjects.deepAssign(target[key], source[key]);\n\t\t\telse\n\t\t\t\ttarget[key] = source[key];\n\t\t}));\n\n\t\treturn target;\n\t},\n\n\t/**\n\t * Checks an object against a template and ensures that the object does not contain any properties not in the template\n\t * and that all of its properties have the correct types as defined by the template.\n\t * @param {object} template The template.\n\t * @param {object} object The object to check against the template.\n\t */\n\tcheckSchemaAgainstTemplate: (template, object) => {\n\t\t// object can contain a subset of template properties but cannot contain any that template does not\n\t\tObject.keys(object).forEach(key => {\n\t\t\tif (isObject(template[key]) && isObject(object[key])) {\n\t\t\t\tobjects.checkSchemaAgainstTemplate(template[key], object[key]);\n\t\t\t} else {\n\t\t\t\tif (undefined === template[key])\n\t\t\t\t\tthrow new Error(`unknown '${key}' key in config`);\n\n\t\t\t\tif (!areCompatible(template[key], object[key]))\n\t\t\t\t\tthrow new Error(`override '${key}' property has wrong type`);\n\t\t\t}\n\t\t});\n\t}\n};\n\nmodule.exports = objects;\n"]}