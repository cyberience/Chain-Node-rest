{"version":3,"sources":["../../src/utils/uint64.js"],"names":["convert","require","readUint32At","bytes","i","uint64Module","compact","low","uint64","high","fromUint","value","number","Error","fromBytes","uint8Array","length","fromBytes32","fromHex","input","hexToUint8","view","DataView","buffer","getUint32","toHex","uint32Array","Uint32Array","uint32ToUint8","reverse","uint8ToHex","isZero","module","exports"],"mappings":";;AAAA;;;;;;;;;;;;;;;;;;;;AAoBA;;AAEA,IAAMA,UAAUC,QAAQ,WAAR,CAAhB;;AAEA,IAAMC,eAAe,SAAfA,YAAe,CAACC,KAAD,EAAQC,CAAR;AAAA,QAAeD,MAAMC,CAAN,KAAYD,MAAMC,IAAI,CAAV,KAAgB,CAA5B,KAAkCD,MAAMC,IAAI,CAAV,KAAgB,EAAlD,KAAyDD,MAAMC,IAAI,CAAV,KAAgB,EAAzE,CAAD,KAAmF,CAAjG;AAAA,CAArB;;AAEA;;;;;;AAMA,IAAMC,eAAe;AACpB;;;;;;AAMAC,UAAS,yBAAU;AAClB,MAAMC,MAAMC,OAAO,CAAP,CAAZ;AACA,MAAMC,OAAOD,OAAO,CAAP,CAAb;;AAEA;AACA,MAAI,cAAcC,IAAlB,EACC,OAAOD,MAAP;;AAED;AACA,SAAQC,OAAO,WAAR,GAAuBF,GAA9B;AACA,EAjBmB;;AAmBpB;;;;;AAKAG,WAAU,0BAAU;AACnB,MAAMC,QAAQ,CAAC,CAACC,SAAS,UAAV,MAA0B,CAA3B,EAA+BA,SAAS,WAAV,KAA2B,CAAzD,CAAd;AACA,MAAI,cAAcD,MAAM,CAAN,CAAd,IAA0B,IAAIC,MAA9B,IAAwC,MAAOA,SAAS,CAA5D,EACC,MAAMC,gDAA6CD,MAA7C,QAAN;;AAED,SAAOD,KAAP;AACA,EA9BmB;;AAgCpB;;;;;AAKAG,YAAW,+BAAc;AACxB,MAAI,MAAMC,WAAWC,MAArB,EACC,MAAMH,4CAAyCE,WAAWC,MAApD,QAAN;;AAED,SAAO,CAACd,aAAaa,UAAb,EAAyB,CAAzB,CAAD,EAA8Bb,aAAaa,UAAb,EAAyB,CAAzB,CAA9B,CAAP;AACA,EA1CmB;;AA4CpB;;;;;AAKAE,cAAa,iCAAc;AAC1B,MAAI,MAAMF,WAAWC,MAArB,EACC,MAAMH,4CAAyCE,WAAWC,MAApD,QAAN;;AAED,SAAO,CAACd,aAAaa,UAAb,EAAyB,CAAzB,CAAD,EAA8B,CAA9B,CAAP;AACA,EAtDmB;;AAwDpB;;;;;AAKAG,UAAS,wBAAS;AACjB,MAAI,OAAOC,MAAMH,MAAjB,EACC,MAAMH,4CAAyCM,MAAMH,MAA/C,QAAN;;AAED,MAAMD,aAAaf,QAAQoB,UAAR,CAAmBD,KAAnB,CAAnB;AACA,MAAME,OAAO,IAAIC,QAAJ,CAAaP,WAAWQ,MAAxB,CAAb;AACA,SAAO,CAACF,KAAKG,SAAL,CAAe,CAAf,CAAD,EAAoBH,KAAKG,SAAL,CAAe,CAAf,CAApB,CAAP;AACA,EApEmB;;AAsEpB;;;;;AAKAC,QAAO,uBAAU;AAChB,MAAMC,cAAc,IAAIC,WAAJ,CAAgBnB,MAAhB,CAApB;AACA,MAAMO,aAAaf,QAAQ4B,aAAR,CAAsBF,WAAtB,EAAmCG,OAAnC,EAAnB;AACA,SAAO7B,QAAQ8B,UAAR,CAAmBf,UAAnB,CAAP;AACA,EA/EmB;;AAiFpB;;;;;AAKAgB,SAAQ;AAAA,SAAU,MAAMvB,OAAO,CAAP,CAAN,IAAmB,MAAMA,OAAO,CAAP,CAAnC;AAAA;AAtFY,CAArB;;AAyFAwB,OAAOC,OAAP,GAAiB5B,YAAjB","file":"uint64.js","sourcesContent":["/*\n * Copyright (c) 2016-present,\n * Jaguar0625, gimre, BloodyRookie, Tech Bureau, Corp. All rights reserved.\n *\n * This file is part of Catapult.\n *\n * Catapult is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Catapult is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with Catapult.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n/** @module utils/uint64 */\n\nconst convert = require('./convert');\n\nconst readUint32At = (bytes, i) => (bytes[i] + (bytes[i + 1] << 8) + (bytes[i + 2] << 16) + (bytes[i + 3] << 24)) >>> 0;\n\n/**\n * An exact uint64 representation composed of two 32bit values.\n * @typedef {Array} uint64\n * @property {numeric} 0 The low 32bit value.\n * @property {numeric} 1 The high 32bit value.\n */\nconst uint64Module = {\n\t/**\n\t * Tries to compact a uint64 into a simple numeric.\n\t * @param {module:utils/uint64~uint64} uint64 A uint64 value.\n\t * @returns {numeric|module:utils/uint64~uint64}\n\t * A numeric if the uint64 is no greater than Number.MAX_SAFE_INTEGER or the original uint64 value otherwise.\n\t */\n\tcompact: uint64 => {\n\t\tconst low = uint64[0];\n\t\tconst high = uint64[1];\n\n\t\t// don't compact if the value is >= 2^53\n\t\tif (0x00200000 <= high)\n\t\t\treturn uint64;\n\n\t\t// multiply because javascript bit operations operate on 32bit values\n\t\treturn (high * 0x100000000) + low;\n\t},\n\n\t/**\n\t * Converts a numeric unsigned integer into a uint64.\n\t * @param {Numeric} number The unsigned integer.\n\t * @returns {module:utils/uint64~uint64} The uint64 representation of the input.\n\t */\n\tfromUint: number => {\n\t\tconst value = [(number & 0xFFFFFFFF) >>> 0, (number / 0x100000000) >>> 0];\n\t\tif (0x00200000 <= value[1] || 0 > number || 0 !== (number % 1))\n\t\t\tthrow Error(`number cannot be converted to uint '${number}'`);\n\n\t\treturn value;\n\t},\n\n\t/**\n\t * Converts a (64bit) uint8 array into a uint64.\n\t * @param {Uint8Array} uint8Array A uint8 array.\n\t * @returns {module:utils/uint64~uint64} The uint64 representation of the input.\n\t */\n\tfromBytes: uint8Array => {\n\t\tif (8 !== uint8Array.length)\n\t\t\tthrow Error(`byte array has unexpected size '${uint8Array.length}'`);\n\n\t\treturn [readUint32At(uint8Array, 0), readUint32At(uint8Array, 4)];\n\t},\n\n\t/**\n\t * Converts a (32bit) uint8 array into a uint64.\n\t * @param {Uint8Array} uint8Array A uint8 array.\n\t * @returns {module:utils/uint64~uint64} The uint64 representation of the input.\n\t */\n\tfromBytes32: uint8Array => {\n\t\tif (4 !== uint8Array.length)\n\t\t\tthrow Error(`byte array has unexpected size '${uint8Array.length}'`);\n\n\t\treturn [readUint32At(uint8Array, 0), 0];\n\t},\n\n\t/**\n\t * Parses a hex string into a uint64.\n\t * @param {string} input A hex encoded string.\n\t * @returns {module:utils/uint64~uint64} The uint64 representation of the input.\n\t */\n\tfromHex: input => {\n\t\tif (16 !== input.length)\n\t\t\tthrow Error(`hex string has unexpected size '${input.length}'`);\n\n\t\tconst uint8Array = convert.hexToUint8(input);\n\t\tconst view = new DataView(uint8Array.buffer);\n\t\treturn [view.getUint32(4), view.getUint32(0)];\n\t},\n\n\t/**\n\t * Converts a uint64 into a hex string.\n\t * @param {module:utils/uint64~uint64} uint64 A uint64 value.\n\t * @returns {string} A hex encoded string representing the uint64.\n\t */\n\ttoHex: uint64 => {\n\t\tconst uint32Array = new Uint32Array(uint64);\n\t\tconst uint8Array = convert.uint32ToUint8(uint32Array).reverse();\n\t\treturn convert.uint8ToHex(uint8Array);\n\t},\n\n\t/**\n\t * Returns true if a uint64 is zero.\n\t * @param {module:utils/uint64~uint64} uint64 A uint64 value.\n\t * @returns {boolean} true if the value is zero.\n\t */\n\tisZero: uint64 => 0 === uint64[0] && 0 === uint64[1]\n};\n\nmodule.exports = uint64Module;\n"]}